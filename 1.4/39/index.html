
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pytorch.apachecn.org/1.4/39/">
      
      
        <link rel="prev" href="../37/">
      
      
        <link rel="next" href="../40/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.0">
    
    
      
        <title>使用自定义 C --运算符扩展 TorchScript - 【布客】PyTorch 中文翻译</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.45e1311d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#c-torchscript" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="【布客】PyTorch 中文翻译" class="md-header__button md-logo" aria-label="【布客】PyTorch 中文翻译" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            【布客】PyTorch 中文翻译
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              使用自定义 C --运算符扩展 TorchScript
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/apachecn/pytorch-doc-zh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    apachecn/pytorch-doc-zh
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="【布客】PyTorch 中文翻译" class="md-nav__button md-logo" aria-label="【布客】PyTorch 中文翻译" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    【布客】PyTorch 中文翻译
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/apachecn/pytorch-doc-zh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    apachecn/pytorch-doc-zh
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 中文文档 & 教程
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 新特性
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 新特性
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.13
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.12
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.10
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LatestChanges/PyTorch_V1.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 2.x 中文文档 & 教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 2.x 中文文档 & 教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            中文教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch Recipes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            PyTorch Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/recipes/recipes_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    See All Recipes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/prototype/prototype_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    See All Prototype Recipes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn the Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/quickstart_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/tensorqs_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/data_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets & DataLoaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/transforms_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/buildmodel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build the Neural Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/autogradqs_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic Differentiation with torch.autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/optimization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Model Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/basics/saveloadrun_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and Load the Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to PyTorch on YouTube
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Introduction to PyTorch on YouTube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch - YouTube Series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/introyt1_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/tensors_deeper_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch Tensors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/autogradyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Fundamentals of Autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/modelsyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Models with PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/tensorboardyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch TensorBoard Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/trainingyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training with PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/introyt/captumyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Understanding with Captum
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Learning PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/deep_learning_60min_blitz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Learning with PyTorch: A 60 Minute Blitz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/pytorch_with_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learning PyTorch with Examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/nn_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is torch.nn really?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/tensorboard_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualizing Models, Data, and Training with TensorBoard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Image and Video
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            Image and Video
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/torchvision_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchVision Object Detection Finetuning Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/transfer_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfer Learning for Computer Vision Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/fgsm_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adversarial Example Generation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/dcgan_faces_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCGAN Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/spatial_transformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Transformer Networks Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/vt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Vision Transformer Model for Deployment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
        
          
          <label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Audio
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_io_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio I/O
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_resampling_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Resampling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_data_augmentation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Data Augmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_feature_extractions_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Feature Extractions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_feature_augmentation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Feature Augmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/audio_datasets_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/speech_recognition_pipeline_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speech Recognition with Wav2Vec2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/text_to_speech_with_torchaudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text-to-speech with Tacotron2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/forced_alignment_with_torchaudio_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forced Alignment with Wav2Vec2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" >
        
          
          <label class="md-nav__link" for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Text
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            Text
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/transformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language Modeling with nn.Transformer and torchtext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/bettertransformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fast Transformer Inference with Better Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/char_rnn_classification_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Classifying Names with a Character-Level RNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/char_rnn_generation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Generating Names with a Character-Level RNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/seq2seq_translation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Translation with a Sequence to Sequence Network and Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/text_sentiment_ngrams_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text classification with the torchtext library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/translation_transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language Translation with nn.Transformer and torchtext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/torchtext_custom_dataset_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess custom text dataset using Torchtext
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_8" >
        
          
          <label class="md-nav__link" for="__nav_3_1_8" id="__nav_3_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backends
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_8">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/onnx/intro_onnx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to ONNX
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          <label class="md-nav__link" for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/reinforcement_q_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning (DQN) Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/reinforcement_ppo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning (PPO) with TorchRL Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/mario_rl_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Train a Mario-playing RL Agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          <label class="md-nav__link" for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deploying PyTorch Models in Production
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            Deploying PyTorch Models in Production
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/onnx/intro_onnx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to ONNX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/flask_rest_api_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying PyTorch in Python via a REST API with Flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/Intro_to_TorchScript_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to TorchScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/cpp_export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loading a TorchScript Model in C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/super_resolution_with_onnxruntime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (optional) Exporting a Model from PyTorch to ONNX and Running it using ONNX Runtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/realtime_rpi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real Time Inference on Raspberry Pi 4 (30 fps!)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          <label class="md-nav__link" for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Transforms with FX
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            Code Transforms with FX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/fx_conv_bn_fuser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Building a Convolution/Batch Norm fuser in FX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/fx_profiling_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Building a Simple CPU Performance Profiler with FX
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          <label class="md-nav__link" for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Frontend APIs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            Frontend APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/memory_format_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Channels Last Memory Format in PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/forward_ad_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forward-mode Automatic Differentiation (Beta)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/jacobians_hessians/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jacobians, Hessians, hvp, vhp, and more: composing function transforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/ensembling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model ensembling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/per_sample_grads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Per-sample-gradients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/cpp_frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the PyTorch C++ Frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/torch-script-parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Parallelism in TorchScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/cpp_autograd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd in C++ Frontend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_13" >
        
          
          <label class="md-nav__link" for="__nav_3_1_13" id="__nav_3_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extending PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_13">
            <span class="md-nav__icon md-icon"></span>
            Extending PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/custom_function_double_backward_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Double Backward with Custom Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/custom_function_conv_bn_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fusing Convolution and Batch Norm using Custom Function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/cpp_extension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom C++ and CUDA Extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/torch_script_custom_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending TorchScript with Custom C++ Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/torch_script_custom_classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending TorchScript with Custom C++ Classes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/dispatcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registering a Dispatched Operator in C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/extend_dispatcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending dispatcher for a new backend in C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/privateuseone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Facilitating New Backend Integration by PrivateUse1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_14" >
        
          
          <label class="md-nav__link" for="__nav_3_1_14" id="__nav_3_1_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Optimization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_14">
            <span class="md-nav__icon md-icon"></span>
            Model Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/profiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling your PyTorch Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/tensorboard_profiler_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Profiler With TensorBoard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/hyperparameter_tuning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning with Ray Tune
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/vt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Vision Transformer Model for Deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/parametrizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parametrizations Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/pruning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pruning Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/dynamic_quantization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Dynamic Quantization on an LSTM Word Language Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/dynamic_quantization_bert_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Dynamic Quantization on BERT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/quantized_transfer_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Quantized Transfer Learning for Computer Vision Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/static_quantization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Static Quantization with Eager Mode in PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/torchserve_with_ipex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grokking PyTorch Intel CPU performance from first principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/torchserve_with_ipex_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grokking PyTorch Intel CPU performance from first principles (Part 2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/nvfuser_intro_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started - Accelerate Your Scripts with nvFuser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/ax_multiobjective_nas_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Objective NAS with Ax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/torch_compile_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.compile Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/inductor_debug_cpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inductor CPU backend debugging and profiling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/scaled_dot_product_attention_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (Beta) Implementing High-Performance Transformers with Scaled Dot Product Attention (SDPA)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/scaled_dot_product_attention_tutorial%23using-sdpa-with-torch-compile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using SDPA with torch.compile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/scaled_dot_product_attention_tutorial%23conclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conclusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/knowledge_distillation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Knowledge Distillation Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_15" >
        
          
          <label class="md-nav__link" for="__nav_3_1_15" id="__nav_3_1_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Parallel and Distributed Training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_15">
            <span class="md-nav__icon md-icon"></span>
            Parallel and Distributed Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/distributed/home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed and Parallel Training Tutorials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/dist_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Distributed Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/ddp_series_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Data Parallel in PyTorch - Video Tutorials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/model_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single-Machine Model Parallel Best Practices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/ddp_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Distributed Data Parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/dist_tuto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Distributed Applications with PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/FSDP_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Fully Sharded Data Parallel(FSDP)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/FSDP_adavnced_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Model Training with Fully Sharded Data Parallel (FSDP)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/process_group_cpp_extension_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customize Process Group Backends Using Cpp Extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/rpc_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Distributed RPC Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/rpc_param_server_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing a Parameter Server Using Distributed RPC Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/dist_pipeline_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Pipeline Parallelism Using RPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/rpc_async_execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing Batch RPC Processing Using Asynchronous Executions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/rpc_ddp_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combining Distributed DataParallel with Distributed RPC Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/pipeline_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Transformer models using Pipeline Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/ddp_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Transformer models using Distributed Data Parallel and Pipeline Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/generic_join/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Training with Uneven Inputs Using the Join Context Manager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_16" >
        
          
          <label class="md-nav__link" for="__nav_3_1_16" id="__nav_3_1_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mobile
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_16">
            <span class="md-nav__icon md-icon"></span>
            Mobile
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/deeplabv3_on_ios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Segmentation DeepLabV3 on iOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/deeplabv3_on_android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Segmentation DeepLabV3 on Android
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_17" >
        
          
          <label class="md-nav__link" for="__nav_3_1_17" id="__nav_3_1_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Recommendation Systems
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_17">
            <span class="md-nav__icon md-icon"></span>
            Recommendation Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/intermediate/torchrec_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to TorchRec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/advanced/sharding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploring TorchRec sharding
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_18" >
        
          
          <label class="md-nav__link" for="__nav_3_1_18" id="__nav_3_1_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multimodality
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_18">
            <span class="md-nav__icon md-icon"></span>
            Multimodality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/tutorials/beginner/flava_finetuning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchMultimodal Tutorial: Finetuning FLAVA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文文档
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            中文文档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.0/docs/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.cuda
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 1.7 中文文档
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 1.7 中文文档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    学习 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            学习 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 深度学习：60 分钟的突击
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 深度学习：60 分钟的突击
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    张量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.autograd的简要介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    神经网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    训练分类器
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    通过示例学习 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            通过示例学习 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    热身：NumPy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：张量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：张量和 Autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：定义新的 Autograd 函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：optim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：自定义nn模块
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch：控制流 - 权重共享
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn到底是什么？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 TensorBoard 可视化模型，数据和训练
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    图片/视频
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            图片/视频
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision对象检测微调教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    计算机视觉的迁移学习教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对抗示例生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCGAN 教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    音频
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            音频
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    音频 I/O 和torchaudio的预处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用torchaudio的语音命令识别
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    文本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            文本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/27/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用nn.Transformer和torchtext的序列到序列建模
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/28/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    从零开始的 NLP：使用字符级 RNN 分类名称
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    从零开始的 NLP：使用字符级 RNN 生成名称
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/30/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    从零开始的 NLP：使用序列到序列网络和注意力的翻译
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/31/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用torchtext的文本分类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/32/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchtext语言翻译
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            强化学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/34/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    强化学习（DQN）教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/35/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    训练玩马里奥的 RL 智能体
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    在生产中部署 PyTorch 模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            在生产中部署 PyTorch 模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/37/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过使用 Flask 的 REST API 在 Python 中部署 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/38/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchScript 简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/39/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 C++ 中加载 TorchScript 模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/40/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将模型从 PyTorch 导出到 ONNX 并使用 ONNX 运行时运行它（可选）
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    前端 API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            前端 API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/42/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 中的命名张量简介（原型）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/43/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 中通道在最后的内存格式（beta）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/44/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch C++ 前端
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/45/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自定义 C++ 和 CUDA 扩展
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/46/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用自定义 C++ 运算符扩展 TorchScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/47/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用自定义 C++ 类扩展 TorchScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/48/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchScript 中的动态并行性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/49/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ 前端中的 Autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/50/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 C++ 中注册调度运算符
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    模型优化
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            模型优化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/52/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分析您的 PyTorch 模块
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/53/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 Ray Tune 的超参数调整
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/54/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模型剪裁教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/55/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LSTM 单词语言模型上的动态量化（beta）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/56/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BERT 上的动态量化（Beta）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/57/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 中使用 Eager 模式的静态量化（beta）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/58/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    计算机视觉的量化迁移学习教程（beta）
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    并行和分布式训练
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            并行和分布式训练
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/60/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 分布式概述
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/61/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    单机模型并行最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/62/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式数据并行入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/63/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用 PyTorch 编写分布式应用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/64/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式 RPC 框架入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/65/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用分布式 RPC 框架实现参数服务器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/66/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 RPC 的分布式管道并行化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/67/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用异步执行实现批量 RPC 处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.7/68/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将分布式DataParallel与分布式 RPC 框架相结合
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 1.4 中文文档 & 教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 1.4 中文文档 & 教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    入门
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            入门
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    使用 PyTorch 进行深度学习：60 分钟的闪电战
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            使用 PyTorch 进行深度学习：60 分钟的闪电战
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blitz/tensor_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    什么是PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blitz/autograd_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd：自动求导
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blitz/neural_networks_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    神经网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blitz/cifar10_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    训练分类器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blitz/data_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    可选：数据并行
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    编写自定义数据集，数据加载器和转换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 TensorBoard 可视化模型，数据和训练
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    图片
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            图片
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchVision 对象检测微调教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    转移学习的计算机视觉教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    空间变压器网络教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch 进行神经传递
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对抗示例生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCGAN 教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    音频
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            音频
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchaudio 教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    文本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            文本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: 使用char-RNN对姓氏进行分类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: 生成名称与字符级RNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: 基于注意力机制的 seq2seq 神经网络翻译
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 TorchText 进行文本分类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 TorchText 进行语言翻译
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 nn.Transformer 和 TorchText 进行序列到序列建模
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    命名为 Tensor(实验性）
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            命名为 Tensor(实验性）
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (实验性)PyTorch 中的命名张量简介
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            强化学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    强化学习(DQN)教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    在生产中部署 PyTorch 模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            在生产中部署 PyTorch 模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过带有 Flask 的 REST API 在 Python 中部署 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchScript 简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 C --中加载 TorchScript 模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (可选）将模型从 PyTorch 导出到 ONNX 并使用 ONNX Runtime 运行
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    并行和分布式训练
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            并行和分布式训练
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    单机模型并行最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式数据并行入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用 PyTorch 编写分布式应用程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式 RPC 框架入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (高级）带有 Amazon AWS 的 PyTorch 1.0 分布式训练师
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" checked>
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    扩展 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            扩展 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    使用自定义 C --运算符扩展 TorchScript
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    使用自定义 C --运算符扩展 TorchScript
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      在 C ++中实现自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchscript" class="md-nav__link">
    <span class="md-ellipsis">
      使用 TorchScript 注册自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      建立自定义操作员
    </span>
  </a>
  
    <nav class="md-nav" aria-label="建立自定义操作员">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmake" class="md-nav__link">
    <span class="md-ellipsis">
      用 CMake 构建
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-torchscript" class="md-nav__link">
    <span class="md-ellipsis">
      在 Python 中使用 TorchScript 自定义运算符
    </span>
  </a>
  
    <nav class="md-nav" aria-label="在 Python 中使用 TorchScript 自定义运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      使用自定义运算符进行跟踪
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      将自定义运算符与脚本一起使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-torchscript_1" class="md-nav__link">
    <span class="md-ellipsis">
      在 C ++中使用 TorchScript 自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      结论
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      附录 A：建立自定义操作员的更多方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="附录 A：建立自定义操作员的更多方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jit" class="md-nav__link">
    <span class="md-ellipsis">
      使用 JIT 编译进行构建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setuptools" class="md-nav__link">
    <span class="md-ellipsis">
      使用 Setuptools 构建
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用自定义 C --类扩展 TorchScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../41/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 numpy 和 scipy 创建扩展
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../42/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自定义 C --和 CUDA 扩展
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    模型优化
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            模型优化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../44/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LSTM Word 语言模型上的(实验）动态量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../45/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (实验性）在 PyTorch 中使用 Eager 模式进行静态量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../46/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (实验性）计算机视觉教程的量化转移学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../47/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (实验）BERT 上的动态量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../48/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    修剪教程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 用其他语言
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 用其他语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../50/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch C --前端
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 基础知识
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 基础知识
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../52/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通过示例学习 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../53/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn 到底是什么？
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../56/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动求导机制
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../57/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    广播语义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../58/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU 线程和 TorchScript 推断
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../59/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA 语义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../60/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式 Autograd 设计
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../61/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    扩展 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../62/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    经常问的问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../63/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    大规模部署的功能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../64/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    并行处理最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../65/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    重现性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../66/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    远程参考协议
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../67/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    序列化语义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../68/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows 常见问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../69/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XLA 设备上的 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          
          <label class="md-nav__link" for="__nav_5_14" id="__nav_5_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    语言绑定
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            语言绑定
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../71/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch C -- API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../72/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Java API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_15" >
        
          
          <label class="md-nav__link" for="__nav_5_15" id="__nav_5_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_15">
            <span class="md-nav__icon md-icon"></span>
            Python API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../74/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../75/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../76/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch功能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../77/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch张量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../78/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    张量属性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../79/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动差分包-Torch.Autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.cuda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式通讯包-Torch.Distributed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../82/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    概率分布-torch分布
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.hub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch脚本
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn.init
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.onnx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../87/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.optim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分布式 RPC 框架
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch随机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch稀疏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../92/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch存储
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.bottleneck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../94/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.checkpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.cpp_extension
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.dlpack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.model_zoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.tensorboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../100/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型信息
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    命名张量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../102/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    命名为 Tensors 操作员范围
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../103/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    糟糕！
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_16" >
        
          
          <label class="md-nav__link" for="__nav_5_16" id="__nav_5_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    torchvision参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_16">
            <span class="md-nav__icon md-icon"></span>
            torchvision参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../105/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_17" >
        
          
          <label class="md-nav__link" for="__nav_5_17" id="__nav_5_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    音频参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_17">
            <span class="md-nav__icon md-icon"></span>
            音频参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../107/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchaudio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_18" >
        
          
          <label class="md-nav__link" for="__nav_5_18" id="__nav_5_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    torchtext参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_18">
            <span class="md-nav__icon md-icon"></span>
            torchtext参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../109/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchtext
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_19" >
        
          
          <label class="md-nav__link" for="__nav_5_19" id="__nav_5_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    社区
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_19">
            <span class="md-nav__icon md-icon"></span>
            社区
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../111/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 贡献指南
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../112/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 治理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../113/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 治理| 感兴趣的人
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 1.0 中文文档 & 教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 1.0 中文文档 & 教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    目录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文教程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            中文教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_1" >
        
          
          <label class="md-nav__link" for="__nav_6_2_1" id="__nav_6_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    入门
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_1">
            <span class="md-nav__icon md-icon"></span>
            入门
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_6_2_1_1" id="__nav_6_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 深度学习: 60 分钟极速入门
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 深度学习: 60 分钟极速入门
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/deep_learning_60min_blitz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/blitz_tensor_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    什么是 PyTorch？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/blitz_autograd_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd：自动求导
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/blitz_neural_networks_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    神经网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/blitz_cifar10_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    训练分类器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/blitz_data_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    可选：数据并行处理
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/data_loading_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据加载和处理教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/pytorch_with_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用例子学习 PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/transfer_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    迁移学习教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/deploy_seq2seq_hybrid_frontend_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    混合前端的 seq2seq 模型部署
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/saving_loading_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Saving and Loading Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nn_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is torch.nn really?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2_2" id="__nav_6_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    图像
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            图像
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/finetuning_torchvision_models_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Torchvision 模型微调
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/spatial_transformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    空间变换器网络教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/neural_style_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch 进行图像风格转换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/fgsm_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对抗性示例生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/super_resolution_with_caffe2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 ONNX 将模型从 PyTorch 传输到 Caffe2 和移动端
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_3" >
        
          
          <label class="md-nav__link" for="__nav_6_2_3" id="__nav_6_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    文本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_3">
            <span class="md-nav__icon md-icon"></span>
            文本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/chatbot_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    聊天机器人教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/char_rnn_generation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用字符级别特征的 RNN 网络生成姓氏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/char_rnn_classification_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用字符级别特征的 RNN 网络进行姓氏分类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_6_2_3_4" id="__nav_6_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deep Learning for NLP with Pytorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Deep Learning for NLP with Pytorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/deep_learning_nlp_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在深度学习和 NLP 中使用 Pytorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nlp_pytorch_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nlp_deep_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch 进行深度学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nlp_word_embeddings_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Word Embeddings: Encoding Lexical Semantics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nlp_sequence_models_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    序列模型和 LSTM 网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nlp_advanced_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced: Making Dynamic Decisions and the Bi-LSTM CRF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/seq2seq_translation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基于注意力机制的 seq2seq 神经网络翻译
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_4" >
        
          
          <label class="md-nav__link" for="__nav_6_2_4" id="__nav_6_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    生成
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_4">
            <span class="md-nav__icon md-icon"></span>
            生成
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/dcgan_faces_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCGAN Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_5" >
        
          
          <label class="md-nav__link" for="__nav_6_2_5" id="__nav_6_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_5">
            <span class="md-nav__icon md-icon"></span>
            强化学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/reinforcement_q_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning (DQN) Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_6" >
        
          
          <label class="md-nav__link" for="__nav_6_2_6" id="__nav_6_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    扩展 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_6">
            <span class="md-nav__icon md-icon"></span>
            扩展 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/numpy_extensions_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用 numpy 和 scipy 创建扩展
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/cpp_extension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom C++ and CUDA Extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_script_custom_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending TorchScript with Custom C++ Operators
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_7" >
        
          
          <label class="md-nav__link" for="__nav_6_2_7" id="__nav_6_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    生产性使用
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_7">
            <span class="md-nav__icon md-icon"></span>
            生产性使用
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/dist_tuto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Distributed Applications with PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/aws_distributed_training_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 Amazon AWS 进行分布式训练
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/ONNXLive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ONNX 现场演示教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/cpp_export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 C++ 中加载 PYTORCH 模型
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_8" >
        
          
          <label class="md-nav__link" for="__nav_6_2_8" id="__nav_6_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    其它语言中的 PyTorch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_8">
            <span class="md-nav__icon md-icon"></span>
            其它语言中的 PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/cpp_frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 PyTorch C++ 前端
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文文档
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            中文文档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_1" >
        
          
          <label class="md-nav__link" for="__nav_6_3_1" id="__nav_6_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    注解
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_1">
            <span class="md-nav__icon md-icon"></span>
            注解
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_autograd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动求导机制
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_broadcasting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    广播语义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA 语义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_extending/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_multiprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiprocessing best practices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_randomness/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reproducibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization semantics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/notes_windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows FAQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2" >
        
          
          <label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    包参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_2">
            <span class="md-nav__icon md-icon"></span>
            包参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_6_3_2_1" id="__nav_6_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    torch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            torch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_tensors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_random_sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random sampling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_serialization_parallelism_utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization, Parallelism, Utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_6_3_2_1_5" id="__nav_6_3_2_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Math operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_6_3_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            Math operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_pointwise_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pointwise Ops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_reduction_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reduction Ops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_comparison_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Ops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_spectral_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spectral Ops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_other_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torch_math_operations_blas_lapack_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BLAS and LAPACK Operations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/tensors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.Tensor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/tensor_attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/type_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据类型信息
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/sparse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.sparse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.cuda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nn_functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn.functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/nn_init/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.nn.init
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/optim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.optim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/autograd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic differentiation package - torch.autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/distributed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed communication package - torch.distributed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/distributions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probability distributions - torch.distributions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/jit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Torch Script
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/multiprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    多进程包 - torch.multiprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/bottleneck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.bottleneck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/checkpoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.checkpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/docs_cpp_extension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.cpp_extension
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/dlpack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.dlpack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/hub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.hub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/model_zoo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.utils.model_zoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/onnx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch.onnx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/distributed_deprecated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed communication package (deprecated) - torch.distributed.deprecated
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    torchvision 参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_3">
            <span class="md-nav__icon md-icon"></span>
            torchvision 参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/docs_torchvision_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    目录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torchvision_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision.datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torchvision_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision.models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torchvision_transforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision.transforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.0/torchvision_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision.utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.4 中文文档
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.3 中文文档 & 教程
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.2 中文文档
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contrib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    贡献指南
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apachecn.org/about" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于我们
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apachecn.org/join" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    加入我们
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    中文资源合集
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      在 C ++中实现自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchscript" class="md-nav__link">
    <span class="md-ellipsis">
      使用 TorchScript 注册自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      建立自定义操作员
    </span>
  </a>
  
    <nav class="md-nav" aria-label="建立自定义操作员">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmake" class="md-nav__link">
    <span class="md-ellipsis">
      用 CMake 构建
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-torchscript" class="md-nav__link">
    <span class="md-ellipsis">
      在 Python 中使用 TorchScript 自定义运算符
    </span>
  </a>
  
    <nav class="md-nav" aria-label="在 Python 中使用 TorchScript 自定义运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      使用自定义运算符进行跟踪
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      将自定义运算符与脚本一起使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-torchscript_1" class="md-nav__link">
    <span class="md-ellipsis">
      在 C ++中使用 TorchScript 自定义运算符
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      结论
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      附录 A：建立自定义操作员的更多方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="附录 A：建立自定义操作员的更多方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jit" class="md-nav__link">
    <span class="md-ellipsis">
      使用 JIT 编译进行构建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setuptools" class="md-nav__link">
    <span class="md-ellipsis">
      使用 Setuptools 构建
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/apachecn/pytorch-doc-zh/edit/master/docs/1.4/39.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/apachecn/pytorch-doc-zh/raw/master/docs/1.4/39.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="c-torchscript">使用自定义 C ++运算符扩展 TorchScript</h1>
<blockquote>
<p>原文： <a href="https://pytorch.org/tutorials/advanced/torch_script_custom_ops.html">https://pytorch.org/tutorials/advanced/torch_script_custom_ops.html</a></p>
</blockquote>
<p>PyTorch 1.0 版本向 PyTorch 引入了一种新的编程模型，称为 <a href="https://pytorch.org/docs/master/jit.html">TorchScript</a> 。 TorchScript 是 Python 编程语言的子集，可以通过 TorchScript 编译器进行解析，编译和优化。 此外，已编译的 TorchScript 模型可以选择序列化为磁盘文件格式，然后可以从纯 C ++(以及 Python）加载并运行该文件格式以进行推理。</p>
<p>TorchScript 支持<code>torch</code>包提供的大量操作子集，使您可以纯粹表示为 PyTorch 的“标准库”中的一系列张量操作来表示多种复杂模型。 但是，有时您可能需要使用自定义 C ++或 CUDA 函数扩展 TorchScript。 虽然我们建议您仅在无法(简单有效地）将您的想法表达为简单的 Python 函数时才诉诸该选项，但我们确实提供了一个非常友好且简单的界面，用于使用 <a href="https://pytorch.org/cppdocs/#aten">ATen</a> 定义自定义 C ++和 CUDA 内核。 ，PyTorch 的高性能 C ++张量库。 绑定到 TorchScript 后，您可以将这些自定义内核(或“ ops”）嵌入到 TorchScript 模型中，并以 Python 或直接以 C ++的序列化形式执行它们。</p>
<p>以下段落提供了编写 TorchScript 自定义操作以调用 <a href="https://www.opencv.org">OpenCV</a> (使用 C ++编写的计算机视觉库）的示例。 我们将讨论如何在 C ++中使用张量，如何有效地将它们转换为第三方张量格式(在这种情况下为 OpenCV <a href="#id1">或</a> Mat），如何在 TorchScript 运行时中注册您的运算符 最后是如何编译运算符并在 Python 和 C ++中使用它。</p>
<h2 id="c">在 C ++中实现自定义运算符</h2>
<p>在本教程中，我们将公开 <a href="https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#warpperspective">warpPerspective</a> 函数，该函数将透视转换应用于图像，从 OpenCV 到 TorchScript 作为自定义运算符。 第一步是用 C ++编写自定义运算符的实现。 让我们将此实现的文件称为<code>op.cpp</code>，并使其如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>#include &lt;opencv2/opencv.hpp&gt;
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>#include &lt;torch/script.h&gt;
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>torch::Tensor warp_perspective(torch::Tensor image, torch::Tensor warp) {
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  cv::Mat image_mat(/*rows=*/image.size(0),
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                    /*cols=*/image.size(1),
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                    /*type=*/CV_32FC1,
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                    /*data=*/image.data&lt;float&gt;());
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  cv::Mat warp_mat(/*rows=*/warp.size(0),
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>                   /*cols=*/warp.size(1),
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>                   /*type=*/CV_32FC1,
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>                   /*data=*/warp.data&lt;float&gt;());
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  cv::Mat output_mat;
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>  cv::warpPerspective(image_mat, output_mat, warp_mat, /*dsize=*/{8, 8});
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>  torch::Tensor output = torch::from_blob(output_mat.ptr&lt;float&gt;(), /*sizes=*/{8, 8});
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>  return output.clone();
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>}
</code></pre></div>
<p>该运算符的代码很短。 在文件顶部，我们包含 OpenCV 标头文件<code>opencv2/opencv.hpp</code>和<code>torch/script.h</code>标头，该标头暴露了 PyTorch C ++ API 中所有需要编写自定义 TorchScript 运算符的必需属性。 我们的函数<code>warp_perspective</code>具有两个参数：输入<code>image</code>和我们希望应用于图像的<code>warp</code>变换矩阵。 这些输入的类型是<code>torch::Tensor</code>，这是 C ++中 PyTorch 的张量类型(也是 Python 中所有张量的基础类型）。 我们的<code>warp_perspective</code>函数的返回类型也将是<code>torch::Tensor</code>。</p>
<p>小贴士</p>
<p>有关 ATen 的更多信息，请参见<a href="https://pytorch.org/cppdocs/notes/tensor_basics.html">本说明</a>，ATen 是为 PyTorch 提供<code>Tensor</code>类的库。 此外，本教程的<a href="https://pytorch.org/cppdocs/notes/tensor_creation.html">描述了如何在 C ++中分配和初始化新的张量对象(此运算符不需要）。</a></p>
<p>注意</p>
<p>TorchScript 编译器了解固定数量的类型。 只有这些类型可以用作自定义运算符的参数。 当前这些类型是：这些类型的<code>torch::Tensor</code>，<code>torch::Scalar</code>，<code>double</code>，<code>int64_t</code>和<code>std::vector</code>。 请注意，仅_，<em>，<code>double</code>和_不，</em>，<code>float</code>，仅_，<em>，<code>int64_t</code>和</em>，_等其他整数类型，例如<code>int</code> 支持<code>short</code>或<code>long</code>。</p>
<p>在函数内部，我们要做的第一件事是将 PyTorch 张量转换为 OpenCV 矩阵，因为 OpenCV 的<code>warpPerspective</code>期望<code>cv::Mat</code>对象作为输入。 幸运的是，有一种方法可以执行此<strong>，而无需复制任何</strong>数据。 在前几行中</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cv::Mat image_mat(/*rows=*/image.size(0),
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>                  /*cols=*/image.size(1),
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>                  /*type=*/CV_32FC1,
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>                  /*data=*/image.data&lt;float&gt;());
</code></pre></div>
<p>我们正在将<a href="https://docs.opencv.org/trunk/d3/d63/classcv_1_1Mat.html#a922de793eabcec705b3579c5f95a643e">称为 OpenCV <code>Mat</code>类的构造函数</a>，将张量转换为<code>Mat</code>对象。 我们将原始<code>image</code>张量的行数和列数，数据类型(在此示例中，我们将其固定为<code>float32</code>）传递给它，最后传递指向基础数据的原始指针– <code>float*</code>。 <code>Mat</code>类的此构造方法的特殊之处在于它不会复制输入数据。 取而代之的是，它将简单地引用此内存来执行<code>Mat</code>上的所有操作。 如果在<code>image_mat</code>上执行就地操作，这将反映在原始<code>image</code>张量中(反之亦然）。 即使我们实际上将数据存储在 PyTorch 张量中，这也使我们能够使用库的本机矩阵类型调用后续的 OpenCV 例程。 我们重复此过程将<code>warp</code> PyTorch 张量转换为<code>warp_mat</code> OpenCV 矩阵：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cv::Mat warp_mat(/*rows=*/warp.size(0),
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>                 /*cols=*/warp.size(1),
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>                 /*type=*/CV_32FC1,
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>                 /*data=*/warp.data&lt;float&gt;());
</code></pre></div>
<p>接下来，我们准备调用我们渴望在 TorchScript 中使用的 OpenCV 函数：<code>warpPerspective</code>。 为此，我们将<code>image_mat</code>和<code>warp_mat</code>矩阵以及称为<code>output_mat</code>的空输出矩阵传递给 OpenCV 函数。 我们还指定了我们希望输出矩阵(图像）为<code>dsize</code>的大小。 对于此示例，它被硬编码为<code>8 x 8</code>：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>cv::Mat output_mat;
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>cv::warpPerspective(image_mat, output_mat, warp_mat, /*dsize=*/{8, 8});
</code></pre></div>
<p>我们的自定义运算符实现的最后一步是将<code>output_mat</code>转换回 PyTorch 张量，以便我们可以在 PyTorch 中进一步使用它。 这与我们先前在另一个方向进行转换的操作极为相似。 在这种情况下，PyTorch 提供了<code>torch::from_blob</code>方法。 在这种情况下， <em>blob</em> 旨在表示一些不透明的，扁平的指向内存的指针，我们希望将其解释为 PyTorch 张量。 对<code>torch::from_blob</code>的调用如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>torch::from_blob(output_mat.ptr&lt;float&gt;(), /*sizes=*/{8, 8})
</code></pre></div>
<p>我们在 OpenCV <code>Mat</code>类上使用<code>.ptr&amp;lt;float&amp;gt;()</code>方法来获取指向基础数据的原始指针(就像之前的 PyTorch 张量的<code>.data&amp;lt;float&amp;gt;()</code>一样）。 我们还指定了张量的输出形状，我们将其硬编码为<code>8 x 8</code>。 然后<code>torch::from_blob</code>的输出是<code>torch::Tensor</code>，指向 OpenCV 矩阵拥有的内存。</p>
<p>从我们的运算符实现返回该张量之前，我们必须在张量上调用<code>.clone()</code>以执行基础数据的存储副本。 这样做的原因是<code>torch::from_blob</code>返回的张量不拥有其数据。 那时，数据仍归 OpenCV 矩阵所有。 但是，此 OpenCV 矩阵将超出范围，并在函数末尾重新分配。 如果我们按原样返回<code>output</code>张量，那么当我们在函数外使用它时，它将指向无效的内存。 调用<code>.clone()</code>将返回一个新的张量，其中包含新张量自己拥有的原始数据的副本。 因此，返回外部世界是安全的。</p>
<h2 id="torchscript">使用 TorchScript 注册自定义运算符</h2>
<p>现在，已经在 C ++中实现了自定义运算符，我们需要在 T​​orchScript 运行时和编译器中将_注册为_。 这将使 TorchScript 编译器可以在 TorchScript 代码中解析对我们自定义运算符的引用。 注册非常简单。 对于我们的情况，我们需要编写：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>static auto registry =
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  torch::RegisterOperators(&quot;my_ops::warp_perspective&quot;, &amp;warp_perspective);
</code></pre></div>
<p><code>op.cpp</code>文件的全局范围内的某个位置。 这将创建一个全局变量<code>registry</code>，该变量将在其构造函数中向 TorchScript 注册我们的运算符(即每个程序一次）。 我们指定运算符的名称，以及指向其实现的指针(我们之前编写的函数）。 该名称包括两部分：<em>命名空间</em>(<code>my_ops</code>）和我们正在注册的特定运算符的名称(<code>warp_perspective</code>）。 名称空间和操作员名称由两个冒号(<code>::</code>）分隔。</p>
<p>Tip</p>
<p>如果要注册多个运算符，可以在构造函数之后将调用链接到<code>.op()</code>：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>static auto registry =
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  torch::RegisterOperators(&quot;my_ops::warp_perspective&quot;, &amp;warp_perspective)
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  .op(&quot;my_ops::another_op&quot;, &amp;another_op)
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  .op(&quot;my_ops::and_another_op&quot;, &amp;and_another_op);
</code></pre></div>
<p>在后台，<code>RegisterOperators</code>将执行许多相当复杂的 C ++模板元编程魔术技巧，以推断我们传递给它的函数指针的参数和返回值类型(<code>&amp;warp_perspective</code>）。 此信息用于为我们的操作员形成_功能模式_。 函数模式是操作员的结构化表示形式，一种“签名”或“原型”，由 TorchScript 编译器用来验证 TorchScript 程序的正确性。</p>
<h2 id="_1">建立自定义操作员</h2>
<p>现在，我们已经用 C ++实现了自定义运算符并编写了其注册代码，是时候将该运算符构建到一个(共享的）库中了，可以将其加载到 Python 中进行研究和实验，或者加载到 C ++中以在非 Python 中进行推理。 环境。 有多种方法可以使用纯 CMake 或<code>setuptools</code>之类的 Python 替代方法来构建我们的运算符。 为简洁起见，以下段落仅讨论 CMake 方法。 本教程的附录深入探讨了基于 Python 的替代方法。</p>
<h3 id="cmake">用 CMake 构建</h3>
<p>为了使用 <a href="https://cmake.org">CMake</a> 构建系统将自定义运算符构建到共享库中，我们需要编写一个简短的<code>CMakeLists.txt</code>文件并将其与之前的<code>op.cpp</code>文件一起放置。 为此，让我们就一个看起来像这样的目录结构达成一致：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>warp-perspective/
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  op.cpp
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  CMakeLists.txt
</code></pre></div>
<p>另外，请确保从 <a href="https://pytorch.org/get-started/locally">pytorch.org</a> 中获取 LibTorch 发行版的最新版本，该软件包打包了 PyTorch 的 C ++库和 CMake 构建文件。 将解压缩的发行版放置在文件系统中可访问的位置。 以下段落将将该位置称为<code>/path/to/libtorch</code>。 我们的<code>CMakeLists.txt</code>文件的内容应为以下内容：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>cmake_minimum_required(VERSION 3.1 FATAL_ERROR)
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>project(warp_perspective)
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>find_package(Torch REQUIRED)
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>find_package(OpenCV REQUIRED)
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a># Define our library target
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>add_library(warp_perspective SHARED op.cpp)
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a># Enable C++11
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>target_compile_features(warp_perspective PRIVATE cxx_range_for)
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a># Link against LibTorch
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>target_link_libraries(warp_perspective &quot;${TORCH_LIBRARIES}&quot;)
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a># Link against OpenCV
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>target_link_libraries(warp_perspective opencv_core opencv_imgproc)
</code></pre></div>
<p>警告</p>
<p>此设置对构建环境进行了一些假设，特别是有关 OpenCV 安装的假设。 上面的<code>CMakeLists.txt</code>文件已在运行 Ubuntu Xenial 的 Docker 容器中通过<code>apt</code>安装了<code>libopencv-dev</code>进行了测试。 如果它对您不起作用，并且您感到困惑，请使用<a href="https://github.com/pytorch/extension-script">随附的教程资料库</a>中的<code>Dockerfile</code>构建一个隔离的，可复制的环境，在其中可以使用本教程中的代码。 如果您遇到其他麻烦，请在教程资料库中提交问题，或在<a href="https://discuss.pytorch.org/">我们的论坛</a>中发布问题。</p>
<p>现在要构建我们的操作员，我们可以从<code>warp_perspective</code>文件夹中运行以下命令：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$ mkdir build
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>$ cd build
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>$ cmake -DCMAKE_PREFIX_PATH=/path/to/libtorch ..
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>-- The C compiler identification is GNU 5.4.0
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>-- The CXX compiler identification is GNU 5.4.0
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>-- Check for working C compiler: /usr/bin/cc
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>-- Check for working C compiler: /usr/bin/cc -- works
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>-- Detecting C compiler ABI info
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>-- Detecting C compiler ABI info - done
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>-- Detecting C compile features
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>-- Detecting C compile features - done
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>-- Check for working CXX compiler: /usr/bin/c++
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>-- Check for working CXX compiler: /usr/bin/c++ -- works
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>-- Detecting CXX compiler ABI info
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>-- Detecting CXX compiler ABI info - done
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>-- Detecting CXX compile features
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>-- Detecting CXX compile features - done
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>-- Looking for pthread.h
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>-- Looking for pthread.h - found
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>-- Looking for pthread_create
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>-- Looking for pthread_create - not found
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>-- Looking for pthread_create in pthreads
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>-- Looking for pthread_create in pthreads - not found
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>-- Looking for pthread_create in pthread
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>-- Looking for pthread_create in pthread - found
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>-- Found Threads: TRUE
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>-- Found torch: /libtorch/lib/libtorch.so
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>-- Configuring done
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>-- Generating done
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>-- Build files have been written to: /warp_perspective/build
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>$ make -j
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>Scanning dependencies of target warp_perspective
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>[ 50%] Building CXX object CMakeFiles/warp_perspective.dir/op.cpp.o
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>[100%] Linking CXX shared library libwarp_perspective.so
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a>[100%] Built target warp_perspective
</code></pre></div>
<p>它将在<code>build</code>文件夹中放置<code>libwarp_perspective.so</code>共享库文件。 在上面的<code>cmake</code>命令中，应将<code>/path/to/libtorch</code>替换为未压缩的 LibTorch 发行版的路径。</p>
<p>我们将在下面进一步探讨如何使用和调用我们的运算符，但是为了早日获得成功，我们可以尝试在 Python 中运行以下代码：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>&gt;&gt;&gt; import torch
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>&gt;&gt;&gt; torch.ops.load_library(&quot;/path/to/libwarp_perspective.so&quot;)
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>&gt;&gt;&gt; print(torch.ops.my_ops.warp_perspective)
</code></pre></div>
<p>在这里，<code>/path/to/libwarp_perspective.so</code>应该是我们刚刚构建的<code>libwarp_perspective.so</code>共享库的相对或绝对路径。 如果一切顺利，这应该打印类似</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>&lt;built-in method my_ops::warp_perspective of PyCapsule object at 0x7f618fc6fa50&gt;
</code></pre></div>
<p>这是我们稍后将用来调用自定义运算符的 Python 函数。</p>
<h2 id="python-torchscript">在 Python 中使用 TorchScript 自定义运算符</h2>
<p>将我们的自定义运算符构建到共享库后，我们就可以在 Python 的 TorchScript 模型中使用此运算符了。 这有两个部分：首先将运算符加载到 Python 中，其次在 TorchScript 代码中使用运算符。</p>
<p>您已经了解了如何将运算符导入 Python：<code>torch.ops.load_library()</code>。 此函数采用包含自定义运算符的共享库的路径，并将其加载到当前进程中。 加载共享库还将执行我们放入自定义运算符实现文件中的全局<code>RegisterOperators</code>对象的构造函数。 这将在 TorchScript 编译器中注册我们的自定义运算符，并允许我们在 TorchScript 代码中使用该运算符。</p>
<p>您可以将已加载的运算符称为<code>torch.ops.&amp;lt;namespace&amp;gt;.&amp;lt;function&amp;gt;</code>，其中<code>&amp;lt;namespace&amp;gt;</code>是运算符名称的名称空间部分，而<code>&amp;lt;function&amp;gt;</code>是运算符的函数名称。 对于我们上面编写的运算符，名称空间为<code>my_ops</code>，函数名称为<code>warp_perspective</code>，这意味着我们的运算符可以作为<code>torch.ops.my_ops.warp_perspective</code>使用。 尽管可以在脚本化或跟踪的 TorchScript 模块中使用此函数，但我们也可以仅在原始的 PyTorch 中使用它，并将其传递给常规 PyTorch 张量：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>&gt;&gt;&gt; import torch
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>&gt;&gt;&gt; torch.ops.load_library(&quot;libwarp_perspective.so&quot;)
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>&gt;&gt;&gt; torch.ops.my_ops.warp_perspective(torch.randn(32, 32), torch.rand(3, 3))
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>tensor([[0.0000, 0.3218, 0.4611,  ..., 0.4636, 0.4636, 0.4636],
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>      [0.3746, 0.0978, 0.5005,  ..., 0.4636, 0.4636, 0.4636],
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>      [0.3245, 0.0169, 0.0000,  ..., 0.4458, 0.4458, 0.4458],
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>      ...,
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>      [0.1862, 0.1862, 0.1692,  ..., 0.0000, 0.0000, 0.0000],
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>      [0.1862, 0.1862, 0.1692,  ..., 0.0000, 0.0000, 0.0000],
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>      [0.1862, 0.1862, 0.1692,  ..., 0.0000, 0.0000, 0.0000]])
</code></pre></div>
<p>注意</p>
<p>幕后发生的事情是，第一次使用 Python 访问<code>torch.ops.namespace.function</code>时，TorchScript 编译器(在 C ++平台上）将查看是否已注册函数<code>namespace::function</code>，如果已注册，则将 Python 句柄返回给该函数， 我们可以随后使用它从 Python 调用我们的 C ++运算符实现。 这是 TorchScript 自定义运算符和 C ++扩展之间的一个值得注意的区别：C ++扩展是使用 pybind11 手动绑定的，而 TorchScript 自定义操作则是由 PyTorch 自己动态绑定的。 Pybind11 在绑定到 Python 的类型和类方面为您提供了更大的灵活性，因此建议将其用于纯粹渴望的代码，但 TorchScript ops 不支持它。</p>
<p>从这里开始，您可以在脚本或跟踪代码中使用自定义运算符，就像<code>torch</code>包中的其他函数一样。 实际上，诸如<code>torch.matmul</code>之类的“标准库”功能与自定义运算符的注册路径大致相同，这使得自定义运算符在 TorchScript 中的使用方式和位置方面真正成为一等公民。</p>
<h3 id="_2">使用自定义运算符进行跟踪</h3>
<p>首先，将我们的运算符嵌入到跟踪函数中。 回想一下，为了进行跟踪，我们从一些原始的 Pytorch 代码开始：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>def compute(x, y, z):
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    return x.matmul(y) + torch.relu(z)
</code></pre></div>
<p>然后调用<code>torch.jit.trace</code>。 我们进一步传递<code>torch.jit.trace</code>一些示例输入，它将输入到我们的实现中，以记录输入流过它时发生的操作顺序。 这样的结果实际上是渴望的 PyTorch 程序的“冻结”版本，TorchScript 编译器可以对其进行进一步的分析，优化和序列化：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>&gt;&gt;&gt; inputs = [torch.randn(4, 8), torch.randn(8, 5), torch.randn(4, 5)]
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>&gt;&gt;&gt; trace = torch.jit.trace(compute, inputs)
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>&gt;&gt;&gt; print(trace.graph)
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>graph(%x : Float(4, 8)
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    %y : Float(8, 5)
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    %z : Float(4, 5)) {
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>  %3 : Float(4, 5) = aten::matmul(%x, %y)
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>  %4 : Float(4, 5) = aten::relu(%z)
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>  %5 : int = prim::Constant[value=1]()
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>  %6 : Float(4, 5) = aten::add(%3, %4, %5)
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>  return (%6);
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>}
</code></pre></div>
<p>现在，令人兴奋的启示是，我们可以简单地将自定义运算符放到 PyTorch 跟踪中，就好像它是<code>torch.relu</code>或任何其他<code>torch</code>函数一样：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>torch.ops.load_library(&quot;libwarp_perspective.so&quot;)
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>def compute(x, y, z):
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    x = torch.ops.my_ops.warp_perspective(x, torch.eye(3))
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    return x.matmul(y) + torch.relu(z)
</code></pre></div>
<p>然后像以前一样跟踪它：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>&gt;&gt;&gt; inputs = [torch.randn(4, 8), torch.randn(8, 5), torch.randn(8, 5)]
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>&gt;&gt;&gt; trace = torch.jit.trace(compute, inputs)
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>&gt;&gt;&gt; print(trace.graph)
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>graph(%x.1 : Float(4, 8)
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    %y : Float(8, 5)
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    %z : Float(8, 5)) {
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    %3 : int = prim::Constant[value=3]()
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>    %4 : int = prim::Constant[value=6]()
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>    %5 : int = prim::Constant[value=0]()
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>    %6 : int[] = prim::Constant[value=[0, -1]]()
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>    %7 : Float(3, 3) = aten::eye(%3, %4, %5, %6)
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>    %x : Float(8, 8) = my_ops::warp_perspective(%x.1, %7)
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>    %11 : Float(8, 5) = aten::matmul(%x, %y)
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>    %12 : Float(8, 5) = aten::relu(%z)
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>    %13 : int = prim::Constant[value=1]()
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>    %14 : Float(8, 5) = aten::add(%11, %12, %13)
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>    return (%14);
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>  }
</code></pre></div>
<p>如此简单地将 TorchScript 自定义操作集成到跟踪的 PyTorch 代码中！</p>
<h3 id="_3">将自定义运算符与脚本一起使用</h3>
<p>除了跟踪之外，获得 PyTorch 程序的 TorchScript 表示形式的另一种方法是直接在 TorchScript 中编写代码_。 TorchScript 在很大程度上是 Python 语言的子集，它具有一些限制，使 TorchScript 编译器更容易推理程序。 您可以使用<code>@torch.jit.script</code>标记免费功能，使用<code>@torch.jit.script_method</code>标记类中的方法(也必须从<code>torch.jit.ScriptModule</code>派生），将常规 PyTorch 代码转换为 TorchScript。 有关 TorchScript 注释的更多详细信息，请参见此处的<a href="https://pytorch.org/docs/master/jit.html">。</a>_</p>
<p>使用 TorchScript 而不是跟踪的一个特殊原因是，跟踪无法捕获 PyTorch 代码中的控制流。 因此，让我们考虑使用控制流的此函数：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>def compute(x, y):
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>  if bool(x[0][0] == 42):
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>      z = 5
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>  else:
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>      z = 10
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>  return x.matmul(y) + z
</code></pre></div>
<p>要将此功能从原始 PyTorch 转换为 TorchScript，我们用<code>@torch.jit.script</code>对其进行注释：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>@torch.jit.script
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>def compute(x, y):
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>  if bool(x[0][0] == 42):
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>      z = 5
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>  else:
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>      z = 10
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>  return x.matmul(y) + z
</code></pre></div>
<p>这将及时将<code>compute</code>函数编译为图形表示形式，我们可以在<code>compute.graph</code>属性中进行检查：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>&gt;&gt;&gt; compute.graph
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>graph(%x : Dynamic
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    %y : Dynamic) {
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>  %14 : int = prim::Constant[value=1]()
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>  %2 : int = prim::Constant[value=0]()
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>  %7 : int = prim::Constant[value=42]()
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>  %z.1 : int = prim::Constant[value=5]()
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>  %z.2 : int = prim::Constant[value=10]()
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>  %4 : Dynamic = aten::select(%x, %2, %2)
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>  %6 : Dynamic = aten::select(%4, %2, %2)
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>  %8 : Dynamic = aten::eq(%6, %7)
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>  %9 : bool = prim::TensorToBool(%8)
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>  %z : int = prim::If(%9)
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    block0() {
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>      -&gt; (%z.1)
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>    }
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>    block1() {
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>      -&gt; (%z.2)
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    }
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>  %13 : Dynamic = aten::matmul(%x, %y)
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>  %15 : Dynamic = aten::add(%13, %z, %14)
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>  return (%15);
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>}
</code></pre></div>
<p>现在，就像以前一样，我们可以像脚本代码中的任何其他函数一样使用自定义运算符：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>torch.ops.load_library(&quot;libwarp_perspective.so&quot;)
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>@torch.jit.script
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>def compute(x, y):
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>  if bool(x[0] == 42):
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>      z = 5
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>  else:
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>      z = 10
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>  x = torch.ops.my_ops.warp_perspective(x, torch.eye(3))
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>  return x.matmul(y) + z
</code></pre></div>
<p>当 TorchScript 编译器看到对<code>torch.ops.my_ops.warp_perspective</code>的引用时，它将找到我们通过 C ++中的<code>RegisterOperators</code>对象注册的实现，并将其编译为图形表示形式：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>&gt;&gt;&gt; compute.graph
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>graph(%x.1 : Dynamic
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>    %y : Dynamic) {
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    %20 : int = prim::Constant[value=1]()
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    %16 : int[] = prim::Constant[value=[0, -1]]()
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    %14 : int = prim::Constant[value=6]()
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    %2 : int = prim::Constant[value=0]()
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    %7 : int = prim::Constant[value=42]()
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    %z.1 : int = prim::Constant[value=5]()
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>    %z.2 : int = prim::Constant[value=10]()
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    %13 : int = prim::Constant[value=3]()
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    %4 : Dynamic = aten::select(%x.1, %2, %2)
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>    %6 : Dynamic = aten::select(%4, %2, %2)
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>    %8 : Dynamic = aten::eq(%6, %7)
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>    %9 : bool = prim::TensorToBool(%8)
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>    %z : int = prim::If(%9)
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>      block0() {
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>        -&gt; (%z.1)
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>      }
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>      block1() {
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>        -&gt; (%z.2)
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>      }
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>    %17 : Dynamic = aten::eye(%13, %14, %2, %16)
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>    %x : Dynamic = my_ops::warp_perspective(%x.1, %17)
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>    %19 : Dynamic = aten::matmul(%x, %y)
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>    %21 : Dynamic = aten::add(%19, %z, %20)
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>    return (%21);
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>  }
</code></pre></div>
<p>请特别注意图形末尾对<code>my_ops::warp_perspective</code>的引用。</p>
<p>Attention</p>
<p>TorchScript 图形表示仍可能更改。 不要依靠它看起来像这样。</p>
<p>在 Python 中使用自定义运算符时，确实如此。 简而言之，您可以使用<code>torch.ops.load_library</code>导入包含运算符的库，并像其他任何<code>torch</code>运算符一样，从跟踪或编写脚本的 TorchScript 代码中调用自定义操作。</p>
<h2 id="c-torchscript_1">在 C ++中使用 TorchScript 自定义运算符</h2>
<p>TorchScript 的一项有用功能是能够将模型序列化到磁盘文件中。 该文件可以通过有线方式发送，存储在文件系统中，或者更重要的是，可以动态反序列化和执行，而无需保留原始源代码。 这在 Python 中是可能的，但在 C ++中也是可能的。 为此，PyTorch 为<a href="https://pytorch.org/cppdocs/">提供了纯 C ++ API</a> ，用于反序列化以及执行 TorchScript 模型。 如果还没有的话，请阅读<a href="https://pytorch.org/tutorials/advanced/cpp_export.html">有关使用 C ++</a> 加载和运行序列化 TorchScript 模型的教程，接下来的几段将基于该教程构建。</p>
<p>简而言之，即使从文件反序列化并以 C ++运行，也可以像常规<code>torch</code>运算符一样执行自定义运算符。 唯一的要求是将我们先前构建的自定义运算符共享库与执行模型的 C ++应用程序链接。 在 Python 中，只需调用<code>torch.ops.load_library</code>即可。 在 C ++中，您需要在使用的任何构建系统中将共享库与主应用程序链接。 下面的示例将使用 CMake 展示这一点。</p>
<p>Note</p>
<p>从技术上讲，您还可以在运行时将共享库动态加载到 C ++应用程序中，就像在 Python 中一样。 在 Linux 上，可以使用 dlopen 来执行此操作。 在其他平台上也存在等效项。</p>
<p>在上面链接的 C ++执行教程的基础上，让我们从一个文件中的最小 C ++应用程序开始，该文件位于与自定义运算符不同的文件夹中的<code>main.cpp</code>，该文件加载并执行序列化的 TorchScript 模型：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>#include &lt;torch/script.h&gt; // One-stop header.
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>#include &lt;iostream&gt;
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>#include &lt;memory&gt;
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>int main(int argc, const char* argv[]) {
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>  if (argc != 2) {
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>    std::cerr &lt;&lt; &quot;usage: example-app &lt;path-to-exported-script-module&gt;\n&quot;;
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>    return -1;
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>  }
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>  // Deserialize the ScriptModule from a file using torch::jit::load().
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>  std::shared_ptr&lt;torch::jit::script::Module&gt; module = torch::jit::load(argv[1]);
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>  std::vector&lt;torch::jit::IValue&gt; inputs;
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>  inputs.push_back(torch::randn({4, 8}));
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>  inputs.push_back(torch::randn({8, 5}));
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>  torch::Tensor output = module-&gt;forward(std::move(inputs)).toTensor();
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>  std::cout &lt;&lt; output &lt;&lt; std::endl;
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>}
</code></pre></div>
<p>以及一个小的<code>CMakeLists.txt</code>文件：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>cmake_minimum_required(VERSION 3.1 FATAL_ERROR)
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>project(example_app)
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>find_package(Torch REQUIRED)
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>add_executable(example_app main.cpp)
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>target_link_libraries(example_app &quot;${TORCH_LIBRARIES}&quot;)
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>target_compile_features(example_app PRIVATE cxx_range_for)
</code></pre></div>
<p>在这一点上，我们应该能够构建应用程序：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$ mkdir build
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>$ cd build
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>$ cmake -DCMAKE_PREFIX_PATH=/path/to/libtorch ..
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>-- The C compiler identification is GNU 5.4.0
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>-- The CXX compiler identification is GNU 5.4.0
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>-- Check for working C compiler: /usr/bin/cc
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>-- Check for working C compiler: /usr/bin/cc -- works
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>-- Detecting C compiler ABI info
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>-- Detecting C compiler ABI info - done
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>-- Detecting C compile features
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>-- Detecting C compile features - done
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>-- Check for working CXX compiler: /usr/bin/c++
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>-- Check for working CXX compiler: /usr/bin/c++ -- works
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>-- Detecting CXX compiler ABI info
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>-- Detecting CXX compiler ABI info - done
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>-- Detecting CXX compile features
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>-- Detecting CXX compile features - done
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>-- Looking for pthread.h
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>-- Looking for pthread.h - found
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>-- Looking for pthread_create
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>-- Looking for pthread_create - not found
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>-- Looking for pthread_create in pthreads
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>-- Looking for pthread_create in pthreads - not found
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>-- Looking for pthread_create in pthread
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>-- Looking for pthread_create in pthread - found
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>-- Found Threads: TRUE
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>-- Found torch: /libtorch/lib/libtorch.so
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>-- Configuring done
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>-- Generating done
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>-- Build files have been written to: /example_app/build
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>$ make -j
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>Scanning dependencies of target example_app
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>[ 50%] Building CXX object CMakeFiles/example_app.dir/main.cpp.o
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>[100%] Linking CXX executable example_app
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>[100%] Built target example_app
</code></pre></div>
<p>并在尚未通过模型的情况下运行它：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>$ ./example_app
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>usage: example_app &lt;path-to-exported-script-module&gt;
</code></pre></div>
<p>接下来，让我们序列化我们先前编写的使用自定义运算符的脚本函数：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>torch.ops.load_library(&quot;libwarp_perspective.so&quot;)
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>@torch.jit.script
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>def compute(x, y):
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>  if bool(x[0][0] == 42):
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>      z = 5
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>  else:
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>      z = 10
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>  x = torch.ops.my_ops.warp_perspective(x, torch.eye(3))
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>  return x.matmul(y) + z
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>compute.save(&quot;example.pt&quot;)
</code></pre></div>
<p>最后一行将脚本功能序列化为一个名为“ example.pt”的文件。 如果我们随后将此序列化模型传递给我们的 C ++应用程序，则可以立即运行它：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>$ ./example_app example.pt
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>terminate called after throwing an instance of &#39;torch::jit::script::ErrorReport&#39;
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>what():
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>Schema not found for node. File a bug report.
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>Node: %16 : Dynamic = my_ops::warp_perspective(%0, %19)
</code></pre></div>
<p>或者可能不是。 也许还没有。 当然！ 我们尚未将自定义运算符库与我们的应用程序链接。 让我们立即执行此操作，并正确进行操作，让我们稍微更新一下文件组织，如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>example_app/
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>  CMakeLists.txt
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>  main.cpp
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>  warp_perspective/
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>    CMakeLists.txt
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>    op.cpp
</code></pre></div>
<p>这将允许我们将<code>warp_perspective</code>库 CMake 目标添加为应用目标的子目录。 <code>example_app</code>文件夹中的顶层<code>CMakeLists.txt</code>应该如下所示：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>cmake_minimum_required(VERSION 3.1 FATAL_ERROR)
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>project(example_app)
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>find_package(Torch REQUIRED)
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>add_subdirectory(warp_perspective)
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>add_executable(example_app main.cpp)
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>target_link_libraries(example_app &quot;${TORCH_LIBRARIES}&quot;)
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>target_link_libraries(example_app -Wl,--no-as-needed warp_perspective)
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>target_compile_features(example_app PRIVATE cxx_range_for)
</code></pre></div>
<p>基本的 CMake 配置与以前非常相似，只是我们将<code>warp_perspective</code> CMake 构建添加为子目录。 一旦其 CMake 代码运行，我们就将我们的<code>example_app</code>应用程序与<code>warp_perspective</code>共享库链接起来。</p>
<p>Attention</p>
<p>上面的示例中嵌入了一个关键细节：<code>warp_perspective</code>链接行的<code>-Wl,--no-as-needed</code>前缀。 这是必需的，因为我们实际上不会在应用程序代码中从<code>warp_perspective</code>共享库中调用任何函数。 我们只需要运行全局<code>RegisterOperators</code>对象的构造函数即可。 麻烦的是，这使链接器感到困惑，并使其认为可以完全跳过针对库的链接。 在 Linux 上，<code>-Wl,--no-as-needed</code>标志强制执行链接(注意：该标志特定于 Linux！）。 还有其他解决方法。 最简单的方法是在操作员库中定义_一些函数_，您需要从主应用程序中调用该函数。 这可能就像在某个标头中声明的函数<code>void init();</code>一样简单，然后在运算符库中将其定义为<code>void init() { }</code>。 在主应用程序中调用此<code>init()</code>函数会给链接器以印象，这是一个值得链接的库。 不幸的是，这不在我们的控制范围之内，我们宁愿让您知道其原因和简单的解决方法，而不是让您将一些不透明的宏放入代码中。</p>
<p>现在，由于我们现在在顶层找到了<code>Torch</code>软件包，因此<code>warp_perspective</code>子目录中的<code>CMakeLists.txt</code>文件可以缩短一些。 它看起来应该像这样：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>find_package(OpenCV REQUIRED)
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>add_library(warp_perspective SHARED op.cpp)
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>target_compile_features(warp_perspective PRIVATE cxx_range_for)
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>target_link_libraries(warp_perspective PRIVATE &quot;${TORCH_LIBRARIES}&quot;)
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>target_link_libraries(warp_perspective PRIVATE opencv_core opencv_photo)
</code></pre></div>
<p>让我们重新构建示例应用程序，该应用程序还将与自定义运算符库链接。 在顶层<code>example_app</code>目录中：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>$ mkdir build
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>$ cd build
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>$ cmake -DCMAKE_PREFIX_PATH=/path/to/libtorch ..
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>-- The C compiler identification is GNU 5.4.0
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>-- The CXX compiler identification is GNU 5.4.0
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>-- Check for working C compiler: /usr/bin/cc
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>-- Check for working C compiler: /usr/bin/cc -- works
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>-- Detecting C compiler ABI info
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>-- Detecting C compiler ABI info - done
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>-- Detecting C compile features
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>-- Detecting C compile features - done
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>-- Check for working CXX compiler: /usr/bin/c++
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>-- Check for working CXX compiler: /usr/bin/c++ -- works
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>-- Detecting CXX compiler ABI info
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>-- Detecting CXX compiler ABI info - done
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>-- Detecting CXX compile features
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>-- Detecting CXX compile features - done
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>-- Looking for pthread.h
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>-- Looking for pthread.h - found
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>-- Looking for pthread_create
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>-- Looking for pthread_create - not found
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>-- Looking for pthread_create in pthreads
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>-- Looking for pthread_create in pthreads - not found
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>-- Looking for pthread_create in pthread
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>-- Looking for pthread_create in pthread - found
<a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>-- Found Threads: TRUE
<a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>-- Found torch: /libtorch/lib/libtorch.so
<a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a>-- Configuring done
<a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>-- Generating done
<a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a>-- Build files have been written to: /warp_perspective/example_app/build
<a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a>$ make -j
<a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a>Scanning dependencies of target warp_perspective
<a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a>[ 25%] Building CXX object warp_perspective/CMakeFiles/warp_perspective.dir/op.cpp.o
<a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>[ 50%] Linking CXX shared library libwarp_perspective.so
<a id="__codelineno-31-35" name="__codelineno-31-35" href="#__codelineno-31-35"></a>[ 50%] Built target warp_perspective
<a id="__codelineno-31-36" name="__codelineno-31-36" href="#__codelineno-31-36"></a>Scanning dependencies of target example_app
<a id="__codelineno-31-37" name="__codelineno-31-37" href="#__codelineno-31-37"></a>[ 75%] Building CXX object CMakeFiles/example_app.dir/main.cpp.o
<a id="__codelineno-31-38" name="__codelineno-31-38" href="#__codelineno-31-38"></a>[100%] Linking CXX executable example_app
<a id="__codelineno-31-39" name="__codelineno-31-39" href="#__codelineno-31-39"></a>[100%] Built target example_app
</code></pre></div>
<p>如果现在运行<code>example_app</code>二进制文件并将其传递给序列化模型，我们应该得出一个圆满的结局：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>$ ./example_app example.pt
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>11.4125   5.8262   9.5345   8.6111  12.3997
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a> 7.4683  13.5969   9.0850  11.0698   9.4008
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a> 7.4597  15.0926  12.5727   8.9319   9.0666
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a> 9.4834  11.1747   9.0162  10.9521   8.6269
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>10.0000  10.0000  10.0000  10.0000  10.0000
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>10.0000  10.0000  10.0000  10.0000  10.0000
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>10.0000  10.0000  10.0000  10.0000  10.0000
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>10.0000  10.0000  10.0000  10.0000  10.0000
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>[ Variable[CPUFloatType]{8,5} ]
</code></pre></div>
<p>成功！ 您现在可以推断了。</p>
<h2 id="_4">结论</h2>
<p>本教程向您介绍了如何在 C ++中实现自定义 TorchScript 运算符，如何将其构建到共享库中，如何在 Python 中使用它来定义 TorchScript 模型，最后如何将其加载到 C ++应用程序中以进行推理工作负载。 现在，您可以使用与第三方 C ++库进行接口的 C ++运算符扩展 TorchScript 模型，编写自定义的高性能 CUDA 内核，或实现任何其他需要 Python，TorchScript 和 C ++之间的界线才能平稳融合的用例。</p>
<p>与往常一样，如果您遇到任何问题或疑问，可以使用我们的<a href="https://discuss.pytorch.org/">论坛</a>或 <a href="https://github.com/pytorch/pytorch/issues">GitHub 问题</a>进行联系。 另外，我们的<a href="https://pytorch.org/cppdocs/notes/faq.html">常见问题解答(FAQ）页面</a>可能包含有用的信息。</p>
<h2 id="a">附录 A：建立自定义操作员的更多方法</h2>
<p>“构建自定义运算符”一节介绍了如何使用 CMake 将自定义运算符构建到共享库中。 本附录概述了两种进一步的编译方法。 他们俩都使用 Python 作为编译过程的“驱动程序”或“接口”。 此外，两者都重新使用了<a href="https://pytorch.org/docs/stable/cpp_extension.html">现有基础结构</a> PyTorch 提供了 <a href="https://pytorch.org/tutorials/advanced/cpp_extension.html">* C ++扩展*</a> ，它们是依赖于 [pybind11 <a href="https://github.com/pybind/pybind11"></a> 用于将功能从 C ++“显式”绑定到 Python。</p>
<p>第一种方法是使用 C ++扩展程序的<a href="https://pytorch.org/docs/stable/cpp_extension.html#torch.utils.cpp_extension.load">方便的即时(JIT）编译界面</a>在您首次运行 PyTorch 脚本时在后台编译代码。 第二种方法依赖于古老的<code>setuptools</code>包，并涉及编写单独的<code>setup.py</code>文件。 这样可以进行更高级的配置，并与其他基于<code>setuptools</code>的项目集成。 我们将在下面详细探讨这两种方法。</p>
<h3 id="jit">使用 JIT 编译进行构建</h3>
<p>PyTorch C ++扩展工具包提供的 JIT 编译功能可将您的自定义运算符的编译直接嵌入到您的 Python 代码中，例如 在训练脚本的顶部。</p>
<p>Note</p>
<p>这里的“ JIT 编译”与 TorchScript 编译器中用于优化程序的 JIT 编译无关。 这只是意味着您的自定义运算符 C ++代码将在您首次导入时在系统 &lt;cite&gt;/ tmp&lt;/cite&gt; 目录下的文件夹中编译，就像您自己事先对其进行编译一样。</p>
<p>此 JIT 编译功能有两种形式。 首先，您仍然将操作员实现保存在单独的文件(<code>op.cpp</code>）中，然后使用<code>torch.utils.cpp_extension.load()</code>编译扩展名。 通常，此函数将返回暴露您的 C ++扩展的 Python 模块。 但是，由于我们没有将自定义运算符编译到其自己的 Python 模块中，因此我们只想编译一个普通的共享库。 幸运的是，<code>torch.utils.cpp_extension.load()</code>有一个参数<code>is_python_module</code>，可以将其设置为<code>False</code>，以表明我们仅对构建共享库感兴趣，而对 Python 模块不感兴趣。 然后<code>torch.utils.cpp_extension.load()</code>将会编译并将共享库也加载到当前进程中，就像<code>torch.ops.load_library</code>之前所做的那样：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>import torch.utils.cpp_extension
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>torch.utils.cpp_extension.load(
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    name=&quot;warp_perspective&quot;,
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    sources=[&quot;op.cpp&quot;],
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>    extra_ldflags=[&quot;-lopencv_core&quot;, &quot;-lopencv_imgproc&quot;],
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>    is_python_module=False,
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>    verbose=True
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>)
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>print(torch.ops.my_ops.warp_perspective)
</code></pre></div>
<p>这应该大致打印：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>&lt;built-in method my_ops::warp_perspective of PyCapsule object at 0x7f3e0f840b10&gt;
</code></pre></div>
<p>JIT 编译的第二种形式使您可以将自定义 TorchScript 运算符的源代码作为字符串传递。 为此，请使用<code>torch.utils.cpp_extension.load_inline</code>：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>import torch
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>import torch.utils.cpp_extension
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>op_source = &quot;&quot;&quot;
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>#include &lt;opencv2/opencv.hpp&gt;
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>#include &lt;torch/script.h&gt;
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>torch::Tensor warp_perspective(torch::Tensor image, torch::Tensor warp) {
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>  cv::Mat image_mat(/*rows=*/image.size(0),
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>                    /*cols=*/image.size(1),
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>                    /*type=*/CV_32FC1,
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>                    /*data=*/image.data&lt;float&gt;());
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>  cv::Mat warp_mat(/*rows=*/warp.size(0),
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>                   /*cols=*/warp.size(1),
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>                   /*type=*/CV_32FC1,
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>                   /*data=*/warp.data&lt;float&gt;());
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>  cv::Mat output_mat;
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>  cv::warpPerspective(image_mat, output_mat, warp_mat, /*dsize=*/{64, 64});
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>  torch::Tensor output =
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>    torch::from_blob(output_mat.ptr&lt;float&gt;(), /*sizes=*/{64, 64});
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>  return output.clone();
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>}
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>static auto registry =
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>  torch::RegisterOperators(&quot;my_ops::warp_perspective&quot;, &amp;warp_perspective);
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>&quot;&quot;&quot;
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a>torch.utils.cpp_extension.load_inline(
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a>    name=&quot;warp_perspective&quot;,
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a>    cpp_sources=op_source,
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a>    extra_ldflags=[&quot;-lopencv_core&quot;, &quot;-lopencv_imgproc&quot;],
<a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a>    is_python_module=False,
<a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a>    verbose=True,
<a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a>)
<a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a>
<a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a>print(torch.ops.my_ops.warp_perspective)
</code></pre></div>
<p>自然，最佳实践是仅在源代码相当短的情况下才使用<code>torch.utils.cpp_extension.load_inline</code>。</p>
<p>请注意，如果您在 Jupyter Notebook 中使用此功能，则不应多次执行单元格的注册，因为每次执行都会注册一个新库并重新注册自定义运算符。 如果需要重新执行它，请事先重新启动笔记本的 Python 内核。</p>
<h3 id="setuptools">使用 Setuptools 构建</h3>
<p>从 Python 专门构建自定义运算符的第二种方法是使用<code>setuptools</code>。 这样做的好处是<code>setuptools</code>具有用于构建用 C ++编写的 Python 模块的功能非常强大且广泛的接口。 但是，由于<code>setuptools</code>实际上是用于构建 Python 模块而不是普通的共享库(它们没有 Python 期望从模块中获得的必要入口点），因此这种方法可能有点古怪。 也就是说，您需要的是一个<code>setup.py</code>文件来代替<code>CMakeLists.txt</code>，该文件看起来像这样：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>from setuptools import setup
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>from torch.utils.cpp_extension import BuildExtension, CppExtension
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>setup(
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>    name=&quot;warp_perspective&quot;,
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    ext_modules=[
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>        CppExtension(
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>            &quot;warp_perspective&quot;,
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>            [&quot;example_app/warp_perspective/op.cpp&quot;],
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>            libraries=[&quot;opencv_core&quot;, &quot;opencv_imgproc&quot;],
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>        )
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>    ],
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>    cmdclass={&quot;build_ext&quot;: BuildExtension.with_options(no_python_abi_suffix=True)},
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>)
</code></pre></div>
<p>请注意，我们在底部的<code>BuildExtension</code>中启用了<code>no_python_abi_suffix</code>选项。 这指示<code>setuptools</code>在产生的共享库的名称中省略任何特定于 Python-3 的 ABI 后缀。 否则，例如在 Python 3.7 上，该库可能被称为<code>warp_perspective.cpython-37m-x86_64-linux-gnu.so</code>，其中<code>cpython-37m-x86_64-linux-gnu</code>是 ABI 标签，但我们确实只是希望将其称为<code>warp_perspective.so</code></p>
<p>如果现在从<code>setup.py</code>所在的文件夹中的终端中运行<code>python setup.py build develop</code>，我们应该看到类似以下内容：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>$ python setup.py build develop
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>running build
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>running build_ext
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>building &#39;warp_perspective&#39; extension
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>creating build
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>creating build/temp.linux-x86_64-3.7
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>gcc -pthread -B /root/local/miniconda/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/root/local/miniconda/lib/python3.7/site-packages/torch/lib/include -I/root/local/miniconda/lib/python3.7/site-packages/torch/lib/include/torch/csrc/api/include -I/root/local/miniconda/lib/python3.7/site-packages/torch/lib/include/TH -I/root/local/miniconda/lib/python3.7/site-packages/torch/lib/include/THC -I/root/local/miniconda/include/python3.7m -c op.cpp -o build/temp.linux-x86_64-3.7/op.o -DTORCH_API_INCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=warp_perspective -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>cc1plus: warning: command line option &#39;-Wstrict-prototypes&#39; is valid for C/ObjC but not for C++
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>creating build/lib.linux-x86_64-3.7
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>g++ -pthread -shared -B /root/local/miniconda/compiler_compat -L/root/local/miniconda/lib -Wl,-rpath=/root/local/miniconda/lib -Wl,--no-as-needed -Wl,--sysroot=/ build/temp.linux-x86_64-3.7/op.o -lopencv_core -lopencv_imgproc -o build/lib.linux-x86_64-3.7/warp_perspective.so
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>running develop
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>running egg_info
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a>creating warp_perspective.egg-info
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>writing warp_perspective.egg-info/PKG-INFO
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>writing dependency_links to warp_perspective.egg-info/dependency_links.txt
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a>writing top-level names to warp_perspective.egg-info/top_level.txt
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>writing manifest file &#39;warp_perspective.egg-info/SOURCES.txt&#39;
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>reading manifest file &#39;warp_perspective.egg-info/SOURCES.txt&#39;
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a>writing manifest file &#39;warp_perspective.egg-info/SOURCES.txt&#39;
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a>running build_ext
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a>copying build/lib.linux-x86_64-3.7/warp_perspective.so -&gt;
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a>Creating /root/local/miniconda/lib/python3.7/site-packages/warp-perspective.egg-link (link to .)
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>Adding warp-perspective 0.0.0 to easy-install.pth file
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a>
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a>Installed /warp_perspective
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>Processing dependencies for warp-perspective==0.0.0
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a>Finished processing dependencies for warp-perspective==0.0.0
</code></pre></div>
<p>这将产生一个名为<code>warp_perspective.so</code>的共享库，我们可以像之前那样将其传递给<code>torch.ops.load_library</code>，以使我们的操作员对 TorchScript 可见：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>&gt;&gt;&gt; import torch
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>&gt;&gt;&gt; torch.ops.load_library(&quot;warp_perspective.so&quot;)
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>&gt;&gt;&gt; print(torch.ops.custom.warp_perspective)
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>&lt;built-in method custom::warp_perspective of PyCapsule object at 0x7ff51c5b7bd0&gt;
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../37/" class="md-footer__link md-footer__link--prev" aria-label="Previous: (高级）带有 Amazon AWS 的 PyTorch 1.0 分布式训练师">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                (高级）带有 Amazon AWS 的 PyTorch 1.0 分布式训练师
              </div>
            </div>
          </a>
        
        
          
          <a href="../40/" class="md-footer__link md-footer__link--next" aria-label="Next: 使用自定义 C --类扩展 TorchScript">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                使用自定义 C --类扩展 TorchScript
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>